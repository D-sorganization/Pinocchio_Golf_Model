# Ruff configuration for aggressive code quality

target-version = "py313"
line-length = 100

[lint]
# Enable ALL rules then selectively disable
select = ["ALL"]
ignore = [
    "D",      # Docstring checks (we check separately)
    "COM812", # Missing trailing comma (conflicts with black)
    "ISC001", # Single line implicit string concat
]

# Stricter than defaults
fixable = ["ALL"]
unfixable = []

# Exclude legacy code
exclude = [
    "archive/",
    "legacy/",
    "experimental/",
    "*/migrations/",
    "*_pb2.py",
]

[lint.per-file-ignores]
# Tests can be more relaxed
"test_*.py" = [
    "S101",   # Use of assert
    "PLR2004", # Magic numbers allowed in tests
]
"**/tests/*.py" = [
    "S101",
    "PLR2004", 
]
# Example scripts - allow prints and missing type hints for external libraries
"python/coppelia_pinnochio_meshcat_bridge.py" = [
    "ANN001",  # Missing type annotations (external library types)
    "T201",    # Print statements (example script)
    "EXE001",  # Shebang present but file not executable (git tracks executable bit)
    "ICN003",  # typing imports needed for external library types
    "TID253",  # numpy.typing needed for type annotations
    "ANN401",  # Any types needed for external library objects (CoppeliaSim, Pinocchio)
]
"python/pinnochio_polynomial_torque_fitter.py" = [
    "ANN201",  # Missing return type annotations (example script)
    "ANN001",  # Missing type annotations (example script)
    "T201",    # Print statements (example script)
    "TRY003",  # Exception messages (simple example)
    "EM101",   # Exception string literals (simple example)
    "RET504",  # Unnecessary assignments (readability)
    "FBT003",  # Boolean positional (matplotlib API)
    "EXE001",  # Shebang present but file not executable (git tracks executable bit)
]
"python/pinnochio_GUI.py" = [
    "PLR0915", # Too many statements (GUI initialization is complex)
    "N999",    # Invalid module name (legacy naming)
    "TRY301",  # Abstract raise to inner function (not needed for simple error handling)
    "TRY003",  # Long exception messages (acceptable in error handling)
    "EM101",   # Exception string literals (acceptable for simple error messages)
]
# Quality check script - executable script
"scripts/quality_check.py" = [
    "EXE001",  # Shebang present but file not executable (git tracks executable bit)
]

[lint.mccabe]
max-complexity = 10

[lint.pylint]
max-args = 5
max-branches = 10
max-returns = 3
max-statements = 30

[lint.flake8-quotes]
inline-quotes = "double"
multiline-quotes = "double"
docstring-quotes = "double"

[lint.flake8-import-conventions]
banned-from = ["typing"]

[lint.flake8-tidy-imports]
banned-module-level-imports = ["numpy", "pandas"]  # Must import specific items